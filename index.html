<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>FFUN Recon – Page 1</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f4f4f4;
      padding: 16px;
    }
    h1 {
      text-align: center;
    }
    .section {
      background: white;
      padding: 16px;
      margin-bottom: 16px;
      border-radius: 8px;
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      gap: 12px;
    }
    label {
      font-size: 14px;
    }
    input[type="text"], textarea {
      width: 100%;
      padding: 8px;
      margin-top: 4px;
    }
    .item {
      display: grid;
      grid-template-columns: 1fr auto auto auto;
      align-items: center;
      gap: 12px;
      margin: 6px 0;
    }
    .item span {
      font-size: 14px;
    }
    button {
      width: 100%;
      padding: 18px;
      font-size: 18px;
      background: #2563eb;
      color: white;
      border: none;
      border-radius: 8px;
    }
  </style>
</head>
<body>

<h1>FFUN Recon – Page 1</h1>

<div class="section">
  <h3>Vehicle Info</h3>
  <div class="grid">
    <label>VIN <input id="vin"></label>
    <label>Odometer <input id="odometer"></label>
    <label>Stock # <input id="stock_number"></label>
    <label>Year <input id="year"></label>
    <label>Make <input id="make"></label>
    <label>Model <input id="model"></label>
    <label>Colour <input id="colour"></label>
    <label>Engine Type <input id="engine_type"></label>
    <label>Transmission <input id="transmission_type"></label>
    <label>FFUN / Value <input id="inspection_type"></label>
    <label>Technician <input id="tech_name"></label>
  </div>
</div>

<div class="section">
  <h3>Driver’s Compartment</h3>

  <!-- TEMPLATE ITEM -->
  <!-- Copy this pattern for all items -->
  <div class="item" data-field="dc_wipers">
    <span>Windshield wipers & washers</span>
    <label><input type="radio" name="dc_wipers" value="pass"> Pass</label>
    <label><input type="radio" name="dc_wipers" value="note"> Note</label>
    <label><input type="radio" name="dc_wipers" value="fail"> Fail</label>
  </div>

  <div class="item" data-field="dc_defrosters">
    <span>Defrosters & heaters</span>
    <label><input type="radio" name="dc_defrosters" value="pass"> Pass</label>
    <label><input type="radio" name="dc_defrosters" value="note"> Note</label>
    <label><input type="radio" name="dc_defrosters" value="fail"> Fail</label>
  </div>

  <div class="item" data-field="dc_glass">
    <span>Glass</span>
    <label><input type="radio" name="dc_glass" value="pass"> Pass</label>
    <label><input type="radio" name="dc_glass" value="note"> Note</label>
    <label><input type="radio" name="dc_glass" value="fail"> Fail</label>
  </div>

  <div class="item" data-field="dc_horn">
    <span>Horn</span>
    <label><input type="radio" name="dc_horn" value="pass"> Pass</label>
    <label><input type="radio" name="dc_horn" value="note"> Note</label>
    <label><input type="radio" name="dc_horn" value="fail"> Fail</label>
  </div>

</div>

<div class="section">
  <h3>Future Attention Required</h3>
  <textarea id="future_attention" rows="6"></textarea>
</div>

<button onclick="submitForm()">Save & Download PDF</button>

<script>
  async function submitForm() {
    const data = {};

    // text + textarea
    document.querySelectorAll("input[type=text], textarea").forEach(el => {
      data[el.id] = el.value;
    });

    // pass / note / fail radios
    document.querySelectorAll(".item").forEach(item => {
      const field = item.dataset.field;
      const selected = item.querySelector("input:checked");
      data[field] = selected ? selected.value : "";
    });

    const res = await fetch(
      "https://recon-form-pdf-backend.onrender.com/generate-pdf",
      {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(data)
      }
    );

    const blob = await res.blob();
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = `FFUN_Recon_${data.vin || "UNKNOWN"}.pdf`;
    a.click();
  }
</script>

</body>
</html>
